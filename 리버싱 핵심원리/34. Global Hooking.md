# Global Hooking

스텔스 프로세스에서 이어지는 내용이다.

DLL을 주입한 프로세스만 특정 프로세스를 탐지하지 못한다.

DLL이 주입되지 않은 프로세스들은 모든 프로세스를 탐지할 것이다.

따라서 실행중인, 앞으로 실행될 프로세스들에게 모두 DLL을 주입시켜야 완벽한 스텔스라고 할 수 있다.

그래서 CreatProcess라는 함수를 후킹할 수 있는데 이 함수는 내부적으로 NtResumeThread라는 API를 호출하는데 해당 API를 후킹해볼것이다.

CrateProcess는 MDSN에서 공식문서로 제공하는 API이지만 NtResumeThread는 Undocument API이다.

따라서 이름같은게 조금씩 바뀔 수 있다.

일단 지금까지 실행 결과는 explorer.exe에 주입후 프로세스 몇개 실행 시 Taskmgr.exe는 DLL주입이 안되었으며 ProcessExplorer.exe는 주입이 되어 DllInjecter.exe가 안보였다.

하지만 후킹이 잘못되었는지 크롬이나 다른 탐색기가 작동을 안한다... 고쳐야한다.

크롬은 인젝션은 되어서 후킹이 일어났으니 무언가 꼬인것으로 예상된다.

32비트라 주입안되는 프로세스도 있을것인데 같이 생각을 해보아야겠음.

일단 DLL Injecter에 Eject를 하면 타겟 프로세스가 뻗어버리는 문제가 발생하는데 이 문제 먼저 해결을 하는 중이다.